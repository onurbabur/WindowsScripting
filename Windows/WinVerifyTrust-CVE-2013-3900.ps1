# EnableCertPaddingCheck.ps1

# Define the registry path and value
$registryPath1 = "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config"
$registryPath2 = "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config"
$registryName = "EnableCertPaddingCheck"
$registryValue = 1

# Check if the registry key already exists, if not, create it
if (-not (Test-Path $registryPath1)) {
    New-Item -Path $registryPath1 -Force
}

if (-not (Test-Path $registryPath2)) {
    New-Item -Path $registryPath2 -Force
}

# Check if the registry value already exists, if not, create it
if (-not (Test-Path "$registryPath1\$registryName")) {
    Set-ItemProperty -Path $registryPath1 -Name $registryName -Value $registryValue
}

if (-not (Test-Path "$registryPath2\$registryName")) {
    Set-ItemProperty -Path $registryPath2 -Name $registryName -Value $registryValue
}

Write-Host "Registry values updated successfully."